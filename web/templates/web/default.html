{% extends "web/base.html" %}

{% block main %}
  <div class="default">
    <div class="col1 shadow">
      <h2 class="center">{{ page.title|safe }}</h2>
      <div>{{ page.main_content|safe|linebreaks }}</div>

      {# Events & Meetings #}
      {% if request.resolver_match.url_name == 'events_meetings' %}
        <h3>Upcoming Forum Meetings</h3>
        {% if upcoming_meetings %}
          {% for meeting in upcoming_meetings %}
            <p>
              {% if meeting.url %}
                <a href="{{ meeting.url }}">{{ meeting.date }}</a>
              {% else %}
                {{ meeting.date }}
              {% endif %}
            </p>
          {% endfor %}
        {% else %}
          <p>There are no meetings scheduled at this time. Please 
            <a href="/contact">contact the Forum</a> for initial thinking about the next regular 
            meeting date, which will be posted here once it is set.
          </p>
        {% endif %}

        {% if upcoming_events %}
          <h3>Upcoming Events</h3> 
          {% for event in upcoming_events %}
            <p class="center bold">{{ event.date }}, 
              {% if event.url %}
                <a href="{{event.url}}">{{event.title}}</a>
              {% else %}
                {{ event.title }}
              {% endif %}
            </p>
            {% if event.location %}
              <p class="center">{{ event.location }}</p>
            {% endif %}
            {% if event.description %}
              <p>{{ event.description }}</p>
            {% endif %}
          {% endfor %}
        {% endif %}
        
        <h3 class="center">Past Forum Meetings</h3>
        {% if past_meetings %}
          <table class="past_meetings">
            {% for meeting in past_meetings %}
              <tr>
                <td><b>{{meeting.year}}<b></td>
                <td>{{meeting.date|date:"M"}}</td>
                <td>
                  {% if meeting.agenda %}
                    <a href="{{ meeting.agenda.url }}" class="download">Agenda</a>
                  {% else %}
                    &nbsp;
                  {% endif %}
                </td>
                <td>
                  {% if meeting.minutes %}
                    <a href="{{ meeting.minutes.url }}" class="download">Minutes/Highlights</a>
                  {% else %}
                    &nbsp;
                  {% endif %}
                </td>
                <td>
                  {% if meeting.presentation_materials %}
                    <a href="{{ meeting.presentation_materials.url }}" class="download">
                    Presentations/Materials</a>
                  {% else %}
                    &nbsp;
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </table>
        {% endif %}

      {# Membership #}
      {% elif request.resolver_match.url_name == 'membership' %}
        <div id="map">
          This text is hard-coded into the template in a div named "map". Marc's webmap will go here.
        </div>
      {% endif %}

    </div>
    <div class="col2 shadow">
      {% if page.sidebar %}
        {{ page.sidebar|safe|linebreaks }}
      {% else %}
        <div>
          {# include some default language for sidebar if content not provided in Page in admin #}
          {% if request.resolver_match.url_name == 'about' %}
            {% include 'web/sidebar_about.html' %}
          {% elif request.resolver_match.url_name == 'contact' %}
            {% include 'web/sidebar_contact.html' %}
          {% elif request.resolver_match.url_name == 'events_meetings' %}
            {% include 'web/sidebar_events.html' %}
          {% endif %}
        </div>
      {% endif %}    
    </div>
  </div>
{% endblock %}
